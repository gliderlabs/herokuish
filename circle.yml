machine:
  services:
    - docker

dependencies:
  cache_directories:
    - .cache
  pre:
    # CircleCI replaces all github url, which breaks go get
    - echo "" > ~/.gitconfig
    - docker version
    - make deps
  override:
    - make build

test:
  override:
    - tests/shunit2:
        parallel: true
        files:
          - tests/**/tests.sh

deployment:
  release:
    branch: release
    commands:
      - make release
